# Adaptive Education Platform Architecture

## Core Layout
```
src/
├── main.tsx                     # Vite SPA entry point
├── RozmowaApp.tsx               # Top-level app with React Router and Firebase auth
├── index.css                    # Global styles
├── styles/
│   ├── theme.ts                 # Theme initialization and utilities
│   ├── tokens.css               # CSS variables from design tokens
│   ├── globals.css              # Tailwind layer imports
│   └── prose.css                # Typography styles
├── pages/rozmowa/               # Route-level page components
│   ├── MainLayout.tsx           # Shell with nav and responsive chrome
│   ├── Dashboard.tsx            # Main dashboard with stats and cards
│   ├── LearnPage.tsx            # Lesson discovery and skill tree
│   ├── LessonPlayer.tsx         # Adaptive lesson player with exercise flow
│   ├── ReviewPage.tsx           # Spaced repetition review queue
│   ├── ResourceLibrary.tsx      # Additional learning resources
│   ├── ProfilePage.tsx          # User profile and settings
│   └── LeaderboardPage.tsx      # Achievement rankings
├── components/
│   ├── platform/                # Role-specific dashboard building blocks
│   │   ├── TeacherConsole.tsx   # Teacher cockpit with attendance tracking
│   │   ├── ManagerDashboard.tsx # Operations view with cohort metrics
│   │   ├── StudentWorkspace.tsx # Student workspace shell
│   │   └── AICommandCenter.tsx  # AI orchestration and insights
│   ├── exercises/               # Individual exercise components
│   │   ├── ListenAndSelect.tsx  # Audio-based multiple choice
│   │   ├── MultipleChoice.tsx   # Text-based multiple choice
│   │   ├── TypeAnswer.tsx       # Free-text input exercises
│   │   ├── ListenAndType.tsx    # Audio dictation exercises
│   │   ├── FillBlanks.tsx       # Fill-in-the-blank exercises
│   │   ├── DragWords.tsx        # Drag-and-drop word ordering
│   │   └── ImageMatch.tsx       # Image-word matching
│   ├── rozmowa/                 # Shared UI components
│   │   ├── Button.tsx           # Primary button component
│   │   ├── Input.tsx            # Form input component
│   │   ├── ProgressBar.tsx      # Progress visualization
│   │   ├── Badge.tsx            # Achievement badges
│   │   ├── DailyGoalsCard.tsx   # Daily goals widget
│   │   ├── ReviewQueueCard.tsx  # Review queue summary
│   │   └── index.ts             # Component exports
│   ├── Header.tsx               # App header with navigation
│   ├── LandingPage.tsx          # First-visit landing page
│   └── types.ts                 # Component-level type definitions
├── design-system/
│   ├── tokens.ts                # Unified design tokens (colors, spacing, typography)
├── tailwind.config.js           # Tailwind configuration (uses design tokens)
├── data/
│   ├── lessons.ts               # Single source of truth for skill tree and exercises
│   ├── achievements.ts          # Achievement definitions and criteria
│   └── mockCourses.ts           # Sample course data
├── lib/
│   ├── state/                   # Custom Zustand-lite stores
│   │   ├── zustand-lite.ts      # Lightweight Zustand implementation
│   │   ├── zustand-persist-lite.ts # Persist middleware for localStorage
│   │   └── academics.ts         # Academic state store (attendance, alerts, snapshots)
│   ├── sm2.ts                   # Spaced repetition algorithm
│   └── utils.ts                 # Formatting and helper utilities
├── hooks/
│   └── useLocalStorage.ts       # localStorage persistence hook
├── firebase.ts                  # Firebase auth configuration
├── i18n/                        # Internationalization config and translations
├── types.ts                     # Shared domain models and exercise shapes
└── vite-env.d.ts                # Vite type declarations
```

**Production Server:**
- Build output: `dist/` (generated by `vite build`)
- Server: `server.js` (minimal Node.js static file server)
- No backend API routes; fully client-side SPA
- All state persisted to localStorage or Firebase

```
tests/
├── unit/                        # Vitest focused suites
│   └── platformState.test.ts
├── integration/                 # React Testing Library harnesses
└── e2e/                         # Playwright specs (retained existing setup)
```

## Data Flow
- **Content**: Static lesson data and skill tree defined in `src/data/lessons.ts`
- **State Management**: Custom Zustand-lite stores with localStorage persistence
  - Academic state (attendance, AI alerts, snapshots) in `src/lib/state/academics.ts`
  - User progress and stats managed in `RozmowaApp.tsx` and persisted to localStorage
- **Authentication**: Firebase Auth with Google provider
- **Client-side only**: No backend API; all logic runs in the browser
- **Persistence**: localStorage for progress/stats/state, Firebase for authentication

## Automation
- **Scripts**: `pnpm run check` (using pnpm as the package manager) runs the `check` script defined in `package.json` (type-check → lint → test)
- **GitHub Actions**: CI pipeline runs checks and Playwright tests
- **Deployment**: Vercel deployment with `vercel-build` script
- **Testing**:
  - Unit tests: Vitest (`pnpm run test:unit`)
  - E2E tests: Playwright (`pnpm run test:e2e`)
  - Combined: `pnpm run check` or `pnpm run ci`
